<div [class.page-loading]="!dataArray"></div>
<div *ngIf="dataArray && dataArray.length === itemCount"> 
    <div [class.menu-backdrop]="showSort || showFilter || showLegend" (click)="showSort = showFilter = showLegend = false"></div>
    <div>
        <div class="row col-12 button-container">
            <div class="dropdown col-3" [class.selected]="showSort">
                <button class="dropbtn" (click)="showSort = !showSort">Sort</button>
                <div class="dropdown-content" >
                    <a (click)="sort('az'); showSort = false;">Alphabetical <span [innerHTML]="getSortOrderIcon('az')"></span></a>
                    <a (click)="sort('benefit'); showSort = false;">Number of Benefits <span [innerHTML]="getSortOrderIcon('benefit')"></span></a>
                    <a (click)="sort('effect'); showSort = false;">Number of Total Effects <span [innerHTML]="getSortOrderIcon('effect')"></span></a>
                </div>
            </div>
            <!-- filter drop down -->
            <div class="dropdown col-3" [class.selected]="showFilter">
                <button class="dropbtn" (click)="showFilter = !showFilter">Hide</button>
                <div class="dropdown-content">
                    <div *ngFor="let option of filterOptions; let i = index;" class="p-l-10" [class.checked]="option.checked">
                        <input type="checkbox" name="filterOptions" value="{{option.name}}" [id]="'item' + i" (ngModelChange)="onFilterChange(i, $event); showFilter = false;"
                            [disabled]="false" [ngModel]="option.checked" />
                        <label class="m-b-0" [for]="'item' + i">
                        {{option.name}}
                    </label>
                    </div>
                    <hr (click)="showFilter = false">
                    <a (click)="removeRows(); showFilter = false;">Hide Selected Rows</a>
                    <a (click)="showAllRows(); showFilter = false;">Unhide All</a>
                </div>
            </div>

            <!-- spacer -->
            <!--<div class="col-2">
            </div>-->

            <!-- save chart button -->
            <div class="dropdown col-3">
                <button class="dropbtn" (click)="saveChart()">Save</button>
            </div>

            <!-- help button -->
            <div class="dropdown col-3">
                <button class="dropbtn" (click)="goToHelp()">?</button>
            </div>
        </div>
        <div class="row">
            <span class="col-3"></span>
            <span class="col-9 text-right column-sort-info">Click a column heading to hide empty rows. </span>
        </div>
        <div class="table-container">
            <table class="benefits-table">
                <thead>
                <th style="vertical-align: middle">
                    <span class="legend-text"><img class="effect-icon" src="../../assets/img/beneficial.png" /> Beneficial</span><br>
                    <span class="legend-text"><img class="effect-icon" src="../../assets/img/assist.png" /> Assists</span><br>
                    <span class="legend-text"><img class="effect-icon" src="../../assets/img/mixed.png" /> Mixed</span><br>
                    <span class="legend-text"><img class="effect-icon" src="../../assets/img/inhibit.png" /> Inhibits</span><br>
                    <span class="legend-text"><img class="effect-icon" src="../../assets/img/negative.png" /> Negative</span><br>
                    <!--<br>
                    <span class="first-heading">{{heading}}</span>-->
                </th>
                <th (click)="columnFilter(selectionHeading.heading)" *ngFor="let selectionHeading of selectedHeadings" [class.column-selected]="filteredColumns[selectionHeading.heading]">
                    <div [ngClass]="getTableHeadingClass(selectionHeading.displayText)"><span [innerHTML]="selectionHeading.displayText"></span></div>
                </th>
                </thead>
                <tbody>
                <tr *ngFor="let item of dataArray; let i = index" [hidden]="item.hidden" [class.row-selected]="item.selected">
                    <td (click)="selectItem(item, i)">
                        {{item.displayText}}
                    </td>
                    <td class="text-center" *ngFor="let selection of selected" (click)="item.values[selection] !== undefined && goToDetails(selection, i)">
                        <div *ngIf="item.values[selection] !== undefined"><img class="effect-icon" [src]="getIcon(item.values[selection])" /></div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>